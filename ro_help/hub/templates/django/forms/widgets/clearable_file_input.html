{% load i18n %}
{% if widget.is_initial %}
<span style="color: #A7ACBB">
    {{ widget.initial_text }}:
</span>
<a href="/dashboard/api/get-document?dataset_iid={{widget.attrs.datasetiid}}&document_name={{widget.name}}" target="_blank">{{ widget.value }}</a>
<!-- <a href="#" onclick="APP.openDocument('{{widget.attrs.datasetiid}}', '{{widget.name}}');">{{ widget.value }}</a> -->
<br>
{% endif %}
<div class="upload-btn-wrapper">
    {% if not widget.attrs.readonly %}
        <button class="btn-upload"> <span><i class="fas fa-upload"></i></span> <span class="input-label">{% trans "Upload document" %}..</span></button>
        <input type="{{ widget.type }}" name="{{ widget.name }}" {% include "django/forms/widgets/attrs.html" %}>
    {% endif %}
</div>


<script>
$(document).ready(function() {
    // https://tympanus.net/codrops/2015/09/15/styling-customizing-file-inputs-smart-way/
    var input = $('input[name="{{widget.name}}"]')

    var label = input.siblings().children(".input-label")
    var labelInitVal = label.html()

    input.on('change', function(e) {
        var fileName = e.target.value.split('\\').pop()

        if (fileName)
            label.html(fileName)
        else
            label.html(labelInitVal)
    });
})
</script>